#!/usr/bin/env bash

modules defaults package

read_default version prefix package
read_default base_url prefix package

package_definition \
  file "otp_src_${package_version}.${archive_format}" \
  dir "otp_src_${package_version}"

dependencies=( ncurses openssl )

configure_flags=(
  --enable-hipe
  --enable-smp-support
  --enable-threads
  --enable-kernel-poll
)

if os_is_darwin ; then
  configure_flags[${#configure_flags[@]}]="--enable-darwin-64bit"
fi

# It is important to build single threaded,
#   which is very amusing given it is for Erlang...
make_command="make -j1"

