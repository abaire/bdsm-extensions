#!/usr/bin/env bash

log "
Note: This will do a standard Nginx install.

Use the 'passenger' BDSM extension for installing Nginx with Passenger.
"

install_package

# Post install configuration
ensure_paths_exist "${config_directories[@]}"

(
enter "$nginx_path"
move_files_to "${nginx_config_path}/${file}" "${nginx_files[@]}"
)

ensure_files_exist \
  "${nginx_config_path}/passenger" # empty file as a placeholder.

install_template "nginx" \
  to "${init_scripts_path}"

install_template "nginx.conf" \
  to "${nginx_config_path}"

install_template "proxy.conf" \
  to "${nginx_config_path}/conf"

ensure_files_are_executable \
  "${init_scripts_path}/nginx"

ensure_user_exists nginx \
  with group nginx

chown_paths "nginx:nginx" "${config_directories[@]}"

