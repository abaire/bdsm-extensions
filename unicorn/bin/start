#!/usr/bin/env bash

[[ ${master_pid} -gt 0 ]] && \
  succeed "Unicorn herd master is already running for $project."

log "Starting unicorn herd master for $project."

[[ -s "$current_path/config/unicorn.rb" ]] || \
  fail "config/unicorn.rb not found, aborting start."

if [[ -s "$current_path/config.ru" ]] ; then
  binary="unicorn"
else
  binary="unicorn_rails"
fi

$binary -c "$current_path/config/unicorn.rb" -E "$environment" -D

log "Unicorn herd master has been launched $project."
